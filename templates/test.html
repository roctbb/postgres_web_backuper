<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bootstrap demo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
</head>
<body id="app">
<ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
    <li>Backuper</li>
    <li class="nav-item" role="presentation">
        <button class="nav-link" type="button" role="tab" @click="showDatabases()">db
        </button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link" type="button" role="tab" @click="showFiles()">file</button>
    </li>
</ul>

<div class="container">
    <div v-if="page === 'files'">FILES</div>
    <div v-if="page === 'databases'">
        <div v-for="database in databases">
            <h3><input type="checkbox" v-model="database.enabled"/> {{ database.name }}</h3>

            <div v-if="database.enabled">
                <div v-for="schema in database.schemas">
                    <input type="checkbox" v-model="schema.enabled"/> {{ schema.name }} <span v-if="schema.enabled">{{ schema.mode }}</span>
                </div>
            </div>

        </div>

    </div>
</div>

<script>
    const app = Vue.createApp({
      data() { [
              {
                   "name": "meds",
                   "enabled": true,
                   "schemas": [
                        {
                            "name": "public",
                            "enabled": true,
                            "mode": "weekly",
                            "delete_days": 31
                        }
                   ]
              },
              {
                   "name": "forms",
                   "enabled": true,
                   "schemas": [
                        {
                            "name": "public",
                            "enabled": true,
                            "mode": "weekly",
                            "delete_days": 31
                        },
                        {
                            "name": "public",
                            "enabled": true,
                            "mode": "weekly",
                            "delete_days": 31
                        }
                   ]
              }

          ]
        }
        return {
          page: "databases",
          databases:
      },
      methods: {
          showDatabases: function () {
               this.page = "databases"
          },
          showFiles: function () {
               this.page = "files"
          }
      },
      async mounted() {
          const url = "/databases";
          try {
            const response = await fetch(url);
            if (!response.ok) {
              throw new Error(`Response status: ${response.status}`);
            }

            const json = await response.json();
            console.log(json)
            //this.databases = await response.json()
          } catch (error) {
            console.error(error.message);
          }
      }
    })

    app.mount('#app')
</script>
</body>
</html>